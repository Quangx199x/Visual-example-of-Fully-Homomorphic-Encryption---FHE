<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FHE Interactive Demo</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }
        h1 {
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .input-section {
            background: rgba(255,255,255,0.15);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            text-align: center;
        }
        .input-group {
            margin: 15px 0;
        }
        .input-group label {
            display: block;
            font-size: 1.2em;
            margin-bottom: 8px;
            font-weight: bold;
        }
        .input-group input {
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            font-size: 1.1em;
            width: 200px;
            text-align: center;
            background: rgba(255,255,255,0.9);
            color: #333;
            outline: none;
            transition: all 0.3s ease;
        }
        .input-group input:focus {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255,215,0,0.5);
        }
        .operation-selector {
            margin: 20px 0;
        }
        .operation-selector select {
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            font-size: 1.1em;
            background: rgba(255,255,255,0.9);
            color: #333;
            outline: none;
            cursor: pointer;
        }
        .step {
            margin: 20px 0;
            padding: 20px;
            background: rgba(255,255,255,0.15);
            border-radius: 10px;
            border-left: 5px solid #ffd700;
            transition: transform 0.3s ease;
        }
        .step:hover {
            transform: translateX(5px);
        }
        .step-number {
            display: inline-block;
            background: #ffd700;
            color: #333;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            font-weight: bold;
            margin-right: 15px;
        }
        .data-box {
            display: inline-block;
            padding: 8px 15px;
            margin: 5px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        .clear-data {
            background: rgba(76, 175, 80, 0.8);
            border: 2px solid #4CAF50;
        }
        .encrypted-data {
            background: rgba(244, 67, 54, 0.8);
            border: 2px solid #f44336;
            animation: pulse 2s infinite;
        }
        .result-data {
            background: rgba(255, 193, 7, 0.8);
            border: 2px solid #FFC107;
            color: #333;
        }
        @keyframes pulse {
            0% { opacity: 0.7; }
            50% { opacity: 1; }
            100% { opacity: 0.7; }
        }
        @keyframes calculate {
            0% { transform: scale(1); }
            50% { transform: scale(1.2) rotate(5deg); }
            100% { transform: scale(1); }
        }
        .calculating {
            animation: calculate 0.5s infinite;
        }
        .math-formula {
            text-align: center;
            font-size: 1.5em;
            margin: 15px 0;
            padding: 15px;
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
            font-family: 'Times New Roman', serif;
        }
        .demo-button {
            background: #ffd700;
            color: #333;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 20px auto;
        }
        .demo-button:hover {
            background: #ffed4a;
            transform: scale(1.05);
        }
        .demo-button:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
        }
        .result-section {
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            display: none;
        }
        .show-result {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .process-arrow {
            text-align: center;
            font-size: 2em;
            margin: 10px 0;
            color: #ffd700;
        }
        .encryption-visual {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            margin: 20px 0;
        }
        .progress-bar {
            width: 100%;
            height: 10px;
            background: rgba(255,255,255,0.2);
            border-radius: 5px;
            overflow: hidden;
            margin: 20px 0;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ffd700, #ffed4a);
            width: 0%;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîê FHE Interactive Calculator</h1>
        
        <div class="input-section">
            <h2>üìù Nh·∫≠p d·ªØ li·ªáu c·ªßa b·∫°n</h2>
            
            <div class="input-group">
                <label for="input1">S·ªë th·ª© nh·∫•t:</label>
                <input type="number" id="input1" value="1" min="0" max="15" step="0.1" placeholder="0-15">
            </div>
            
            <div class="input-group">
                <label for="input2">S·ªë th·ª© hai:</label>
                <input type="number" id="input2" value="5" min="0" max="15" step="0.1" placeholder="0-15">
            </div>
            
            <div class="operation-selector">
                <label for="operation">Ch·ªçn ph√©p t√≠nh:</label>
                <select id="operation">
                    <option value="golden_ratio">T·ª∑ l·ªá v√†ng: (a + ‚àöb) / 2</option>
                    <option value="add">C·ªông: a + b</option>
                    <option value="multiply">Nh√¢n: a √ó b</option>
                    <option value="sqrt_add">‚àöa + ‚àöb</option>
                    <option value="reciprocal">1/a + 1/b</option>
                </select>
            </div>

            <button class="demo-button" onclick="startFHECalculation()">üöÄ B·∫Øt ƒë·∫ßu t√≠nh to√°n FHE</button>
        </div>

        <div id="calculation-steps" style="display: none;">
            <div class="step">
                <span class="step-number">1</span>
                <strong>D·ªØ li·ªáu g·ªëc (r√µ r√†ng):</strong>
                <div class="encryption-visual">
                    <div class="data-box clear-data" id="clear-val1">a</div>
                    <div class="data-box clear-data" id="clear-val2">b</div>
                </div>
            </div>

            <div class="progress-bar">
                <div class="progress-fill" id="progress"></div>
            </div>

            <div class="process-arrow" id="encrypt-arrow" style="display: none;">‚¨áÔ∏è M√É H√ìA ‚¨áÔ∏è</div>

            <div class="step" id="encrypt-step" style="display: none;">
                <span class="step-number">2</span>
                <strong>Sau khi m√£ h√≥a:</strong>
                <div class="encryption-visual">
                    <div class="data-box encrypted-data" id="encrypted-val1">üîí E(a)</div>
                    <div class="data-box encrypted-data" id="encrypted-val2">üîí E(b)</div>
                </div>
                <p><em>D·ªØ li·ªáu hi·ªán ƒë√£ ƒë∆∞·ª£c b·∫£o m·∫≠t ho√†n to√†n!</em></p>
            </div>

            <div class="process-arrow" id="calc-arrow" style="display: none;">‚¨áÔ∏è T√çNH TO√ÅN ‚¨áÔ∏è</div>

            <div class="step" id="calc-step" style="display: none;">
                <span class="step-number">3</span>
                <strong>T√≠nh to√°n tr√™n d·ªØ li·ªáu m√£ h√≥a:</strong>
                <div class="math-formula" id="formula">Ph√©p t√≠nh s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y</div>
                <div class="encryption-visual">
                    <div class="data-box encrypted-data calculating" id="calc-result">üîí E(k·∫øt qu·∫£)</div>
                </div>
                <p><em>Server th·ª±c hi·ªán t√≠nh to√°n m√† kh√¥ng bi·∫øt gi√° tr·ªã th·ª±c!</em></p>
            </div>

            <div class="process-arrow" id="decrypt-arrow" style="display: none;">‚¨áÔ∏è GI·∫¢I M√É ‚¨áÔ∏è</div>

            <div class="result-section" id="result-section">
                <span class="step-number">4</span>
                <strong>K·∫øt qu·∫£ cu·ªëi c√πng:</strong>
                <div class="encryption-visual">
                    <div class="data-box result-data" id="final-result">K·∫øt qu·∫£</div>
                </div>
                <div id="result-explanation"></div>
            </div>
        </div>

        <div class="step" style="background: rgba(0,255,0,0.1); border-left-color: #00ff00;">
            <span class="step-number">üí°</span>
            <strong>L∆∞u √Ω v·ªÅ U4F12:</strong>
            <ul>
                <li><strong>Gi·ªõi h·∫°n:</strong> 0 ‚â§ gi√° tr·ªã < 16 (4 bit nguy√™n)</li>
                <li><strong>ƒê·ªô ch√≠nh x√°c:</strong> 1/4096 ‚âà 0.0002 (12 bit th·∫≠p ph√¢n)</li>
                <li><strong>V√≠ d·ª•:</strong> 1.5 ‚Üí 1.4998, 15.9 ‚Üí 15.8999</li>
            </ul>
        </div>
    </div>

    <script>
        let calculationInProgress = false;

        function startFHECalculation() {
            if (calculationInProgress) return;
            
            const input1 = parseFloat(document.getElementById('input1').value);
            const input2 = parseFloat(document.getElementById('input2').value);
            const operation = document.getElementById('operation').value;
            
            // Validate inputs
            if (isNaN(input1) || isNaN(input2) || input1 < 0 || input1 >= 16 || input2 < 0 || input2 >= 16) {
                alert('Vui l√≤ng nh·∫≠p s·ªë t·ª´ 0 ƒë·∫øn 15.9 (gi·ªõi h·∫°n c·ªßa U4F12)');
                return;
            }
            
            calculationInProgress = true;
            document.querySelector('.demo-button').disabled = true;
            document.querySelector('.demo-button').innerHTML = '‚öôÔ∏è ƒêang x·ª≠ l√Ω...';
            
            // Show calculation steps
            document.getElementById('calculation-steps').style.display = 'block';
            
            // Update clear values
            document.getElementById('clear-val1').innerHTML = input1.toFixed(2);
            document.getElementById('clear-val2').innerHTML = input2.toFixed(2);
            
            // Simulate step-by-step process
            simulateSteps(input1, input2, operation);
        }

        function simulateSteps(input1, input2, operation) {
            let step = 0;
            const totalSteps = 4;
            
            const interval = setInterval(() => {
                step++;
                updateProgress(step / totalSteps * 100);
                
                switch(step) {
                    case 1:
                        // Show encryption
                        document.getElementById('encrypt-arrow').style.display = 'block';
                        setTimeout(() => {
                            document.getElementById('encrypt-step').style.display = 'block';
                            document.getElementById('encrypted-val1').innerHTML = `üîí E(${input1.toFixed(2)})`;
                            document.getElementById('encrypted-val2').innerHTML = `üîí E(${input2.toFixed(2)})`;
                        }, 500);
                        break;
                        
                    case 2:
                        // Show calculation
                        document.getElementById('calc-arrow').style.display = 'block';
                        setTimeout(() => {
                            document.getElementById('calc-step').style.display = 'block';
                            updateFormula(operation, input1, input2);
                        }, 500);
                        break;
                        
                    case 3:
                        // Show decryption
                        document.getElementById('decrypt-arrow').style.display = 'block';
                        setTimeout(() => {
                            document.getElementById('result-section').classList.add('show-result');
                            const result = calculateResult(operation, input1, input2);
                            document.getElementById('final-result').innerHTML = result.toFixed(4);
                            showResultExplanation(operation, input1, input2, result);
                        }, 500);
                        break;
                        
                    case 4:
                        // Complete
                        clearInterval(interval);
                        calculationInProgress = false;
                        document.querySelector('.demo-button').disabled = false;
                        document.querySelector('.demo-button').innerHTML = 'üéØ T√≠nh to√°n m·ªõi';
                        break;
                }
            }, 1500);
        }

        function updateProgress(percent) {
            document.getElementById('progress').style.width = percent + '%';
        }

        function updateFormula(operation, a, b) {
            const formulaElement = document.getElementById('formula');
            let formula = '';
            
            switch(operation) {
                case 'golden_ratio':
                    formula = `œÜ = (${a.toFixed(2)} + ‚àö${b.toFixed(2)}) / 2`;
                    break;
                case 'add':
                    formula = `${a.toFixed(2)} + ${b.toFixed(2)}`;
                    break;
                case 'multiply':
                    formula = `${a.toFixed(2)} √ó ${b.toFixed(2)}`;
                    break;
                case 'sqrt_add':
                    formula = `‚àö${a.toFixed(2)} + ‚àö${b.toFixed(2)}`;
                    break;
                case 'reciprocal':
                    formula = `1/${a.toFixed(2)} + 1/${b.toFixed(2)}`;
                    break;
            }
            
            formulaElement.innerHTML = formula;
        }

        function calculateResult(operation, a, b) {
            switch(operation) {
                case 'golden_ratio':
                    return (a + Math.sqrt(b)) / 2;
                case 'add':
                    return a + b;
                case 'multiply':
                    return a * b;
                case 'sqrt_add':
                    return Math.sqrt(a) + Math.sqrt(b);
                case 'reciprocal':
                    return (1/a) + (1/b);
                default:
                    return 0;
            }
        }

        function showResultExplanation(operation, a, b, result) {
            const explanationElement = document.getElementById('result-explanation');
            let explanation = '';
            
            switch(operation) {
                case 'golden_ratio':
                    explanation = `<p><strong>Gi·∫£i th√≠ch:</strong> T·ª∑ l·ªá v√†ng ƒë∆∞·ª£c t√≠nh b·∫±ng c√¥ng th·ª©c œÜ = (a + ‚àöb) / 2</p>
                                 <p>V·ªõi a=${a}, b=${b}: œÜ = (${a} + ${Math.sqrt(b).toFixed(4)}) / 2 = ${result.toFixed(4)}</p>`;
                    if (a === 1 && b === 5) {
                        explanation += `<p><em>üéØ ƒê√¢y ch√≠nh l√† t·ª∑ l·ªá v√†ng c·ªï ƒëi·ªÉn! œÜ ‚âà 1.618</em></p>`;
                    }
                    break;
                case 'add':
                    explanation = `<p><strong>Ph√©p c·ªông FHE:</strong> ${a} + ${b} = ${result}</p>`;
                    break;
                case 'multiply':
                    explanation = `<p><strong>Ph√©p nh√¢n FHE:</strong> ${a} √ó ${b} = ${result.toFixed(4)}</p>`;
                    break;
                case 'sqrt_add':
                    explanation = `<p><strong>CƒÉn b·∫≠c hai FHE:</strong> ‚àö${a} + ‚àö${b} = ${Math.sqrt(a).toFixed(4)} + ${Math.sqrt(b).toFixed(4)} = ${result.toFixed(4)}</p>`;
                    break;
                case 'reciprocal':
                    explanation = `<p><strong>Ngh·ªãch ƒë·∫£o FHE:</strong> 1/${a} + 1/${b} = ${(1/a).toFixed(4)} + ${(1/b).toFixed(4)} = ${result.toFixed(4)}</p>`;
                    break;
            }
            
            explanationElement.innerHTML = explanation;
        }

        // Reset function
        function resetDemo() {
            document.getElementById('calculation-steps').style.display = 'none';
            document.getElementById('result-section').classList.remove('show-result');
            document.getElementById('progress').style.width = '0%';
            
            // Hide all arrows and steps
            document.getElementById('encrypt-arrow').style.display = 'none';
            document.getElementById('encrypt-step').style.display = 'none';
            document.getElementById('calc-arrow').style.display = 'none';
            document.getElementById('calc-step').style.display = 'none';
            document.getElementById('decrypt-arrow').style.display = 'none';
        }

        // Auto-reset when inputs change
        document.getElementById('input1').addEventListener('input', resetDemo);
        document.getElementById('input2').addEventListener('input', resetDemo);
        document.getElementById('operation').addEventListener('change', resetDemo);
    </script>
</body>
</html>